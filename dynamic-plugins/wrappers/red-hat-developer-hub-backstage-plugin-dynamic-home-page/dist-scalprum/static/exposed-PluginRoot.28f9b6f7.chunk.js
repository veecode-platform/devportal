"use strict";(self.webpackChunkred_hat_developer_hub_backstage_plugin_dynamic_home_page=self.webpackChunkred_hat_developer_hub_backstage_plugin_dynamic_home_page||[]).push([[879],{9353:(e,t,i)=>{i.d(t,{s:()=>n});class n{limit;storageApi;storageKeyPrefix="@backstage/plugin-home:visits";identityApi;static create(e){return new n(e)}constructor(e){this.limit=Math.abs(e.limit??100),this.storageApi=e.storageApi,this.identityApi=e.identityApi}async list(e){let t=[...await this.retrieveAll()];return(e?.orderBy??[]).reverse().forEach((e=>{"asc"===e.direction?t.sort(((t,i)=>this.compare(e,t,i))):t.sort(((t,i)=>this.compare(e,i,t)))})),(e?.filterBy??[]).reverse().forEach((e=>{t=t.filter((t=>{const i=t[e.field];return">"===e.operator?i>e.value:">="===e.operator?i>=e.value:"<"===e.operator?i<e.value:"<="===e.operator?i<=e.value:"=="===e.operator?i===e.value:"!="===e.operator?i!==e.value:"contains"===e.operator&&`${i}`.includes(`${e.value}`)}))})),t.slice(0,e?.limit??8)}async save(e){const t=[...await this.retrieveAll()],i={...e.visit,id:window.crypto.randomUUID(),hits:1,timestamp:Date.now()},n=t.findIndex((e=>e.pathname===i.pathname));return n>=0?(i.id=t[n].id,i.hits=t[n].hits+1,t[n]=i):t.push(i),t.sort(((e,t)=>t.timestamp-e.timestamp)),await this.persistAll(t.splice(0,this.limit)),i}async persistAll(e){const t=await this.getStorageKey();return this.storageApi.set(t,e)}async retrieveAll(){const e=await this.getStorageKey(),t=this.storageApi.snapshot(e);return"unknown"!==t?.presence?t?.value??[]:new Promise(((t,i)=>{const n=this.storageApi.observe$(e).subscribe({next:e=>{const i=e.value??[];n.unsubscribe(),t(i)},error:e=>{n.unsubscribe(),i(e)}})}))}async getStorageKey(){const{userEntityRef:e}=await this.identityApi.getBackstageIdentity();return`${this.storageKeyPrefix}:${e}`}compare(e,t,i){return"number"==typeof t[e.field]?t[e.field]-i[e.field]:`${t[e.field]}`.localeCompare(`${i[e.field]}`)}}},64636:(e,t,i)=>{i.d(t,{A:()=>a});const n=e=>e,a=(()=>{let e=n;return{configure(t){e=t},generate:t=>e(t),reset(){e=n}}})()},84833:(e,t,i)=>{i.d(t,{V:()=>a,m:()=>n});const n=(0,i(9490).createApiRef)({id:"app.developer-hub.quick-access.service"});class a{discoveryApi;configApi;identityApi;constructor(e){this.discoveryApi=e.discoveryApi,this.configApi=e.configApi,this.identityApi=e.identityApi}async getBaseUrl(){const e=this.configApi.getOptionalString("developerHub.proxyPath")??"/developer-hub";return`${await this.discoveryApi.getBaseUrl("proxy")}${e}`}async fetcher(e){const{token:t}=await this.identityApi.getCredentials(),i=await fetch(e,{headers:{"Content-Type":"application/json",...t&&{Authorization:`Bearer ${t}`}}});if(!i.ok)throw new Error(`failed to fetch data, status ${i.status}: ${i.statusText}`);return await i.json()}async getQuickAccessLinks(e){const t=await this.getBaseUrl();return await this.fetcher(e?`${t}${e}`:t)}}},87809:(e,t,i)=>{i.r(t),i.d(t,{CatalogStarredEntitiesCard:()=>v,DynamicCustomizableHomePage:()=>l,DynamicHomePage:()=>p,FeaturedDocsCard:()=>b,Headline:()=>y,JokeCard:()=>P,Markdown:()=>u,MarkdownCard:()=>g,Placeholder:()=>A,QuickAccessCard:()=>h,RecentlyVisitedCard:()=>C,SearchBar:()=>m,TopVisitedCard:()=>f,VisitListener:()=>k,WorldClock:()=>w,dynamicHomePagePlugin:()=>d});var n=i(64636),a=i(9490),o=i(98590),r=i(9353),s=i(84833);const c=(0,a.createRouteRef)({id:"dynamic-home-page"}),d=(0,a.createPlugin)({id:"dynamic-home-page",routes:{root:c},apis:[(0,a.createApiFactory)({api:s.m,deps:{discoveryApi:a.discoveryApiRef,configApi:a.configApiRef,identityApi:a.identityApiRef},factory:({discoveryApi:e,configApi:t,identityApi:i})=>new s.V({discoveryApi:e,configApi:t,identityApi:i})}),(0,a.createApiFactory)({api:o.y,deps:{storageApi:a.storageApiRef,identityApi:a.identityApiRef},factory:({storageApi:e,identityApi:t})=>r.s.create({storageApi:e,identityApi:t})})]}),p=d.provide((0,a.createRoutableExtension)({name:"DynamicHomePage",component:()=>Promise.all([i.e(2135),i.e(5451),i.e(658),i.e(4498),i.e(7907),i.e(9543),i.e(3907),i.e(9605),i.e(2842),i.e(1824),i.e(5197),i.e(6765),i.e(5833),i.e(6266),i.e(3370),i.e(5478),i.e(4218),i.e(2469),i.e(484),i.e(1942),i.e(7976),i.e(5277),i.e(8890),i.e(4994),i.e(7548),i.e(1272)]).then(i.bind(i,73370)).then((e=>e.DynamicHomePage)),mountPoint:c})),l=d.provide((0,a.createRoutableExtension)({name:"DynamicCustomizableHomePage",component:()=>Promise.all([i.e(6449),i.e(2135),i.e(5451),i.e(658),i.e(4498),i.e(7907),i.e(4687),i.e(7578),i.e(9543),i.e(3907),i.e(9605),i.e(8519),i.e(2842),i.e(1824),i.e(1204),i.e(5197),i.e(5988),i.e(6765),i.e(643),i.e(5833),i.e(7552),i.e(6266),i.e(5478),i.e(4218),i.e(2469),i.e(484),i.e(1942),i.e(7976),i.e(5277),i.e(8890),i.e(4994),i.e(7548),i.e(5358)]).then(i.bind(i,17128)).then((e=>e.DynamicCustomizableHomePage)),mountPoint:c})),m=d.provide((0,a.createComponentExtension)({name:"SearchBar",component:{lazy:()=>Promise.all([i.e(5451),i.e(658),i.e(7907),i.e(3907),i.e(9605),i.e(2842),i.e(5197),i.e(5988),i.e(8680),i.e(5478),i.e(4218),i.e(2469),i.e(484),i.e(1942),i.e(5277),i.e(4994),i.e(8254)]).then(i.bind(i,48680)).then((e=>e.SearchBar))}})),h=d.provide((0,a.createComponentExtension)({name:"QuickAccessCard",component:{lazy:()=>Promise.all([i.e(2135),i.e(5451),i.e(658),i.e(4498),i.e(7907),i.e(9543),i.e(3907),i.e(9605),i.e(2842),i.e(1824),i.e(5833),i.e(542),i.e(5478),i.e(4218),i.e(2469),i.e(484),i.e(1942),i.e(7976),i.e(5277),i.e(8890),i.e(4994),i.e(9096)]).then(i.bind(i,20542)).then((e=>e.QuickAccessCard))}})),y=d.provide((0,a.createComponentExtension)({name:"Headline",component:{lazy:()=>Promise.all([i.e(5478),i.e(9941)]).then(i.bind(i,9941)).then((e=>e.Headline))}})),u=d.provide((0,a.createComponentExtension)({name:"Markdown",component:{lazy:()=>Promise.all([i.e(2135),i.e(5451),i.e(658),i.e(4498),i.e(3907),i.e(2842),i.e(5478),i.e(4218),i.e(484),i.e(1942),i.e(7976),i.e(5277),i.e(4994),i.e(8916)]).then(i.bind(i,38916)).then((e=>e.Markdown))}})),g=d.provide((0,a.createComponentExtension)({name:"MarkdownCard",component:{lazy:()=>Promise.all([i.e(2135),i.e(5451),i.e(658),i.e(4498),i.e(7907),i.e(9543),i.e(5833),i.e(5478),i.e(4218),i.e(2469),i.e(484),i.e(1942),i.e(7976),i.e(6614)]).then(i.bind(i,66614)).then((e=>e.MarkdownCard))}})),A=d.provide((0,a.createComponentExtension)({name:"MarkdownCard",component:{lazy:()=>Promise.all([i.e(3907),i.e(2842),i.e(5478),i.e(5277),i.e(4994),i.e(4677)]).then(i.bind(i,61162)).then((e=>e.Placeholder))}})),v=d.provide((0,a.createComponentExtension)({name:"CatalogStarredEntitiesCard",component:{lazy:()=>Promise.all([i.e(6449),i.e(2135),i.e(5451),i.e(658),i.e(4498),i.e(7907),i.e(4687),i.e(7578),i.e(9543),i.e(9605),i.e(8519),i.e(1824),i.e(1204),i.e(5197),i.e(5988),i.e(6765),i.e(643),i.e(7552),i.e(5478),i.e(4218),i.e(2469),i.e(484),i.e(1942),i.e(7976),i.e(8890),i.e(5955)]).then(i.bind(i,28485)).then((e=>e.HomePageStarredEntities))}})),C=d.provide((0,a.createComponentExtension)({name:"RecentlyVisitedCard",component:{lazy:()=>Promise.all([i.e(6449),i.e(2135),i.e(5451),i.e(658),i.e(4498),i.e(7907),i.e(4687),i.e(7578),i.e(9543),i.e(9605),i.e(8519),i.e(1824),i.e(1204),i.e(5197),i.e(5988),i.e(6765),i.e(643),i.e(7552),i.e(5478),i.e(4218),i.e(2469),i.e(484),i.e(1942),i.e(7976),i.e(8890),i.e(5955)]).then(i.bind(i,28485)).then((e=>e.HomePageRecentlyVisited))}})),f=d.provide((0,a.createComponentExtension)({name:"TopVisitedCard",component:{lazy:()=>Promise.all([i.e(6449),i.e(2135),i.e(5451),i.e(658),i.e(4498),i.e(7907),i.e(4687),i.e(7578),i.e(9543),i.e(9605),i.e(8519),i.e(1824),i.e(1204),i.e(5197),i.e(5988),i.e(6765),i.e(643),i.e(7552),i.e(5478),i.e(4218),i.e(2469),i.e(484),i.e(1942),i.e(7976),i.e(8890),i.e(5955)]).then(i.bind(i,28485)).then((e=>e.HomePageTopVisited))}})),b=d.provide((0,a.createComponentExtension)({name:"FeaturedDocsCard",component:{lazy:()=>Promise.all([i.e(2135),i.e(5451),i.e(658),i.e(4498),i.e(7907),i.e(9543),i.e(9605),i.e(1824),i.e(5478),i.e(4218),i.e(2469),i.e(484),i.e(1942),i.e(7976),i.e(8890),i.e(1598)]).then(i.bind(i,61598)).then((e=>e.FeaturedDocsCard))}})),P=d.provide((0,a.createComponentExtension)({name:"JokeCard",component:{lazy:()=>Promise.all([i.e(6449),i.e(2135),i.e(5451),i.e(658),i.e(4498),i.e(7907),i.e(4687),i.e(7578),i.e(9543),i.e(9605),i.e(8519),i.e(1824),i.e(1204),i.e(5197),i.e(5988),i.e(6765),i.e(643),i.e(7552),i.e(5478),i.e(4218),i.e(2469),i.e(484),i.e(1942),i.e(7976),i.e(8890),i.e(5955)]).then(i.bind(i,28485)).then((e=>e.HomePageRandomJoke))}})),k=d.provide((0,a.createComponentExtension)({name:"VisitListener",component:{lazy:()=>Promise.all([i.e(5478),i.e(2469),i.e(8890),i.e(7548),i.e(4872)]).then(i.bind(i,54872)).then((e=>e.VisitListener))}})),w=d.provide((0,a.createComponentExtension)({name:"WorldClock",component:{lazy:()=>Promise.all([i.e(2135),i.e(5451),i.e(658),i.e(4498),i.e(7907),i.e(9543),i.e(9605),i.e(1824),i.e(5478),i.e(4218),i.e(2469),i.e(484),i.e(1942),i.e(7976),i.e(8890),i.e(5607)]).then(i.bind(i,5607)).then((e=>e.WorldClock))}}));n.A.configure((e=>e.startsWith("v5-")?e:`v5-${e}`))},98590:(e,t,i)=>{i.d(t,{Z:()=>a,y:()=>o});var n=i(9490);const a=e=>["<","<=","==","!=",">",">=","contains"].includes(e),o=(0,n.createApiRef)({id:"homepage.visits"})}}]);
//# sourceMappingURL=exposed-PluginRoot.28f9b6f7.chunk.js.map